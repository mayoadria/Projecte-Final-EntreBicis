<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Login - EntreBicis</title>
    <link rel="stylesheet" href="/styles/login.css" />
    <!-- Prueba usando Font Awesome con el prefijo "fas" -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
</head>
<body>
<div class="login-container">
    <div class="login-box">
        <!-- Ahora se muestra visible y editable -->
        <h2 id="login-title" contenteditable="true">LOGIN</h2>
        <form th:action="@{/login}" method="POST" novalidate>
            <div class="input-group">
                <label for="email">Correo</label>
                <input type="text" id="email" name="email" required/>
            </div>

            <div class="input-group">
                <label for="contra">Contrasenya</label>
                <div class="password-field">
                    <input type="password" id="contra" name="contra" required/>
                    <!-- Usamos un emoji divertido para el botón de toggle -->
                    <button type="button" class="toggle-password" onclick="togglePassword()">
                        <i id="toggle-icon" class="fas fa-eye-slash"></i>
                    </button>

                </div>
            </div>

            <div class="btn-container">
                <button type="submit" class="btn-login" id="login-btn">Entrar</button>
            </div>
        </form>
    </div>
</div>

<script>
    // Contador global de clics en el botón de toggle
    let toggleCount = 0;

    function togglePassword() {
        const passwordInput = document.getElementById('contra');
        const toggleIcon = document.getElementById('toggle-icon');
        toggleCount++;

        if (toggleCount < 10) {
            // Comportamiento normal con Font Awesome
            // Aseguramos limpiar el innerHTML por si se hubiera modificado en algún clic anterior
            toggleIcon.innerHTML = '';
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            }
        } else {
            // A partir del décimo clic, eliminamos cualquier clase y contenido anterior
            toggleIcon.className = '';
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                // Insertamos la primera imagen personalizada
                toggleIcon.innerHTML = '<img id="secret-image" src="/styles/images/ojo-rojo.png" alt="Secret1" style="width: 24px; height: 24px;">';
            } else {
                passwordInput.type = 'password';
                // Insertamos la segunda imagen personalizada
                toggleIcon.innerHTML = '<img id="secret-image" src="/styles/images/ojo-cerrado.png" alt="Secret2" style="width: 24px; height: 24px;">';
            }
        }
    }

    const uname = document.querySelector('#email');
    const pass = document.querySelector('#contra');
    const btn = document.querySelector('#login-btn');

    // Deshabilitamos el botón hasta que se rellenen ambos campos
    btn.disabled = true;
    // Posición inicial
    btn.style.transform = 'translate(0, 0)';

    // Función para mover el botón a una posición aleatoria dentro de un rango
    function moveButtonRandom() {
        // Generamos desplazamientos aleatorios en X e Y (entre 50 y 200px, en ambas direcciones)
        let randomX = (Math.random() < 0.5 ? -1 : 1) * (Math.random() * 150 + 50);
        let randomY = (Math.random() < 0.5 ? -1 : 1) * (Math.random() * 150 + 50);
        btn.style.transform = `translate(${randomX}px, ${randomY}px)`;
    }

    function validateInputs() {
        const filled = uname.value.trim() !== '' && pass.value.trim() !== '';
        btn.disabled = !filled;

        if (filled) {
            // Cuando se rellenan, se posiciona de nuevo en el centro
            btn.style.transform = 'translate(0, 0)';
        }
    }

    uname.addEventListener('input', validateInputs);
    pass.addEventListener('input', validateInputs);

    // Cada vez que el mouse entre en el área del botón, si está deshabilitado, se mueve a una nueva posición
    btn.addEventListener('mouseenter', () => {
        if (btn.disabled) {
            moveButtonRandom();
        }
    });


    // Lógica para el título editable
    const loginTitle = document.getElementById('login-title');
    loginTitle.addEventListener('blur', function() {
        if (this.textContent.trim().toLowerCase() === 'longing') {
            const fullScreenDiv = document.createElement('div');
            fullScreenDiv.id = 'full-screen-video';
            fullScreenDiv.style.position = 'fixed';
            fullScreenDiv.style.top = 0;
            fullScreenDiv.style.left = 0;
            fullScreenDiv.style.width = '100%';
            fullScreenDiv.style.height = '100%';
            fullScreenDiv.style.zIndex = 10000;

            const video = document.createElement('video');
            video.src = '/styles/images/EricDoraemon.mp4';  // Ajusta la ruta a tu video
            video.autoplay = true;
            video.loop = true;
            video.muted = true;
            video.style.width = '100%';
            video.style.height = '100%';
            video.style.objectFit = 'cover';

            fullScreenDiv.appendChild(video);
            document.body.appendChild(fullScreenDiv);
        }
    });
</script>



</body>
</html>
