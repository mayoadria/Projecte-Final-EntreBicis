<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ca">
<head>
    <meta charset="UTF-8">
    <title>Rutes</title>

    <!-- Barra lateral i estils propis de la pàgina -->
    <link rel="stylesheet" href="/styles/barraLateral.css"/>
    <link rel="stylesheet" href="/styles/rutes.css"/>

    <!-- Petits retocs visuals per a targetes “sense ruta” -->
    <style>
        .route-card          { cursor: pointer; }
        .route-card.disabled { cursor: default; opacity: .65; }
    </style>
</head>
<body>
<!-- Barra lateral -->
<div th:replace="barraLateral :: barralateral"></div>

<div class="main-content">
    <h1>Rutes</h1>

    <!-- Missatge quan l'usuari no té cap ruta -->
    <div th:if="${routeCards == null || #lists.isEmpty(routeCards)}"
         class="no-routes">
        <p>No hi ha rutes per mostrar.</p>
    </div>

    <!-- GRID de targetes -->
    <div class="routes-grid"
         th:if="${routeCards != null and !#lists.isEmpty(routeCards)}">
        <div class="route-card"
             th:each="card : ${routeCards}"
             th:data-id="${card.id}"
             th:classappend="${card.id == null} ? 'disabled' : ''">

            <!-- Capçalera -->
            <div class="route-header">
                <span class="route-title" th:text="${card.title}">Ruta…</span>

                <div class="route-stats">
                    <div>
                        <span th:text="${card.distance}">2,55</span> Km
                    </div>
                    <div>
                        <span th:text="${card.points}">2,5</span> p
                    </div>
                    <div th:text="${card.time}">10:00</div>
                    <div>
                        <span th:text="${card.avgSpeed}">15</span> km/h
                    </div>
                </div>
            </div>

            <!-- Mapa o miniatura -->
            <img src="/styles/images/LogoEntrebicis.png"
                 alt="Logo Entrebicis"/>

            <!-- Peu -->
            <div class="route-footer">
                <span th:text="${card.userName}">Nom Usuari</span>
            </div>
        </div>
    </div>
</div>

<!-- JS: només navega a detalls si existeix id; altrament avisa -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.route-card').forEach(card => {
            card.addEventListener('click', () => {
                const id = card.dataset.id;
                if (id && id !== 'null' && id.trim() !== '') {
                    window.location.href = `/ruta/detalls/${id}`;
                } else {
                    alert('Aquest usuari encara no té cap ruta registrada.');
                }
            });
        });
    });
</script>
</body>
</html>
